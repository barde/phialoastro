name = "phialo-design"
main = "src/index.ts"
compatibility_date = "2024-09-25"
compatibility_flags = ["nodejs_compat"]
workers_dev = true

[assets]
directory = "../phialo-design/dist"
binding = "ASSETS"

[build]
command = "npm run build"
cwd = "../phialo-design"

# Preview environment for branch deployments
[env.preview]
name = "phialo-design-preview"
workers_dev = true
compatibility_flags = ["nodejs_compat"]

[env.preview.vars]
ENVIRONMENT = "preview"
# Note: WEB3FORMS_ACCESS_KEY is passed during build via GitHub Actions

# Production environment
[env.production]
name = "phialo-design"
route = "phialo.de/*"
zone_id = "YOUR_ZONE_ID"
workers_dev = false
compatibility_flags = ["nodejs_compat"]

[env.production.vars]
ENVIRONMENT = "production"
# Note: WEB3FORMS_ACCESS_KEY must be set in Cloudflare dashboard under Worker settings

[vars]
ENVIRONMENT = "development"

# Email service configuration
# Note: SEND_EMAIL binding will be configured per environment
# Note: Email-related secrets (SENDGRID_API_KEY, TURNSTILE_SECRET_KEY, etc.) 
# should be set using wrangler secret put or in the Cloudflare dashboard

# Default email sending binding (development)
# [[send_email]]
# name = "SEND_EMAIL"

# Test environment for running tests
[env.test]
name = "phialo-design-test"
workers_dev = true
main = "src/index.ts" # Use full implementation for tests
compatibility_flags = ["nodejs_compat"]

[env.test.vars]
ENVIRONMENT = "test"