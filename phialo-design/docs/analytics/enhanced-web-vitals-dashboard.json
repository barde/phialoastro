{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 0},
      "id": 100,
      "panels": [],
      "title": "Core Web Vitals Overview",
      "type": "row"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": 0},
              {"color": "yellow", "value": 2500},
              {"color": "red", "value": 4000}
            ]
          },
          "unit": "ms"
        }
      },
      "gridPos": {"h": 4, "w": 6, "x": 0, "y": 1},
      "id": 1,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT quantileWeighted(0.75)(double1, _sample_interval) AS lcp_p75 FROM VITALS_ANALYTICS WHERE timestamp >= now() - INTERVAL ${time_range} AND blob2 = 'LCP'",
          "refId": "A"
        }
      ],
      "title": "LCP (P75)",
      "type": "stat"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": 0},
              {"color": "yellow", "value": 200},
              {"color": "red", "value": 500}
            ]
          },
          "unit": "ms"
        }
      },
      "gridPos": {"h": 4, "w": 6, "x": 6, "y": 1},
      "id": 2,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT quantileWeighted(0.75)(double1, _sample_interval) AS inp_p75 FROM VITALS_ANALYTICS WHERE timestamp >= now() - INTERVAL ${time_range} AND blob2 = 'INP'",
          "refId": "A"
        }
      ],
      "title": "INP (P75)",
      "type": "stat"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": 0},
              {"color": "yellow", "value": 0.1},
              {"color": "red", "value": 0.25}
            ]
          },
          "unit": "none"
        }
      },
      "gridPos": {"h": 4, "w": 6, "x": 12, "y": 1},
      "id": 3,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT quantileWeighted(0.75)(double1, _sample_interval) AS cls_p75 FROM VITALS_ANALYTICS WHERE timestamp >= now() - INTERVAL ${time_range} AND blob2 = 'CLS'",
          "refId": "A"
        }
      ],
      "title": "CLS (P75)",
      "type": "stat"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": 0},
              {"color": "yellow", "value": 1800},
              {"color": "red", "value": 3000}
            ]
          },
          "unit": "ms"
        }
      },
      "gridPos": {"h": 4, "w": 6, "x": 18, "y": 1},
      "id": 4,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT quantileWeighted(0.75)(double1, _sample_interval) AS fcp_p75 FROM VITALS_ANALYTICS WHERE timestamp >= now() - INTERVAL ${time_range} AND blob2 = 'FCP'",
          "refId": "A"
        }
      ],
      "title": "FCP (P75)",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 5},
      "id": 101,
      "panels": [],
      "title": "Performance Trends",
      "type": "row"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {"legend": false, "tooltip": false, "viz": false},
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {"type": "linear"},
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {"group": "A", "mode": "none"},
            "thresholdsStyle": {"mode": "off"}
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": 0}]},
          "unit": "ms"
        },
        "overrides": [
          {
            "matcher": {"id": "byName", "options": "CLS"},
            "properties": [
              {"id": "unit", "value": "none"},
              {"id": "custom.axisPlacement", "value": "right"}
            ]
          }
        ]
      },
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 6},
      "id": 5,
      "options": {
        "legend": {
          "calcs": ["mean", "lastNotNull"],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {"mode": "multi", "sort": "none"}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 0,
          "queryType": "sql",
          "rawSql": "SELECT\n  toStartOfInterval(toDateTime(double2 / 1000), INTERVAL 1 HOUR) AS time,\n  blob2 AS metric,\n  quantileWeighted(0.75)(double1, _sample_interval) AS value\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob2 IN ('LCP', 'INP', 'CLS', 'FCP', 'TTFB')\nGROUP BY time, metric\nORDER BY time",
          "refId": "A"
        }
      ],
      "title": "Core Web Vitals Trends",
      "transformations": [
        {"id": "prepareTimeSeries", "options": {"format": "multi"}},
        {"id": "renameByRegex", "options": {"regex": "value (.*)", "renamePattern": "$1"}}
      ],
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 14},
      "id": 102,
      "panels": [],
      "title": "Performance Distribution",
      "type": "row"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "percentage",
            "steps": [
              {"color": "red", "value": 0},
              {"color": "yellow", "value": 50},
              {"color": "green", "value": 75}
            ]
          },
          "unit": "percent"
        }
      },
      "gridPos": {"h": 6, "w": 4, "x": 0, "y": 15},
      "id": 6,
      "options": {
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  (sum(if(blob3 = 'good', _sample_interval, 0)) / sum(_sample_interval)) * 100 AS pass_rate\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob2 = 'LCP'",
          "refId": "A"
        }
      ],
      "title": "LCP Pass Rate",
      "type": "gauge"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "percentage",
            "steps": [
              {"color": "red", "value": 0},
              {"color": "yellow", "value": 50},
              {"color": "green", "value": 75}
            ]
          },
          "unit": "percent"
        }
      },
      "gridPos": {"h": 6, "w": 4, "x": 4, "y": 15},
      "id": 7,
      "options": {
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  (sum(if(blob3 = 'good', _sample_interval, 0)) / sum(_sample_interval)) * 100 AS pass_rate\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob2 = 'INP'",
          "refId": "A"
        }
      ],
      "title": "INP Pass Rate",
      "type": "gauge"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "percentage",
            "steps": [
              {"color": "red", "value": 0},
              {"color": "yellow", "value": 50},
              {"color": "green", "value": 75}
            ]
          },
          "unit": "percent"
        }
      },
      "gridPos": {"h": 6, "w": 4, "x": 8, "y": 15},
      "id": 8,
      "options": {
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  (sum(if(blob3 = 'good', _sample_interval, 0)) / sum(_sample_interval)) * 100 AS pass_rate\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob2 = 'CLS'",
          "refId": "A"
        }
      ],
      "title": "CLS Pass Rate",
      "type": "gauge"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": 0},
              {"color": "yellow", "value": 2500},
              {"color": "red", "value": 4000}
            ]
          },
          "unit": "ms"
        }
      },
      "gridPos": {"h": 6, "w": 12, "x": 12, "y": 15},
      "id": 9,
      "options": {
        "displayMode": "gradient",
        "orientation": "horizontal",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": true},
        "showThresholdLabels": false,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  blob4 AS device_type,\n  quantileWeighted(0.75)(double1, _sample_interval) AS lcp_value\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob2 = 'LCP'\n  AND blob4 != ''\nGROUP BY device_type",
          "refId": "A"
        }
      ],
      "title": "LCP by Device Type",
      "type": "bargauge"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 21},
      "id": 103,
      "panels": [],
      "title": "Page Performance Analysis",
      "type": "row"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "cellOptions": {"type": "auto"},
            "inspect": false
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": 0}]}
        },
        "overrides": [
          {
            "matcher": {"id": "byName", "options": "p75_lcp"},
            "properties": [
              {"id": "unit", "value": "ms"},
              {"id": "thresholds", "value": {
                "mode": "absolute",
                "steps": [
                  {"color": "green", "value": 0},
                  {"color": "yellow", "value": 2500},
                  {"color": "red", "value": 4000}
                ]
              }},
              {"id": "custom.width", "value": 120}
            ]
          },
          {
            "matcher": {"id": "byName", "options": "page_views"},
            "properties": [{"id": "custom.width", "value": 100}]
          }
        ]
      },
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 22},
      "id": 10,
      "options": {
        "showHeader": true,
        "sortBy": [{"desc": true, "displayName": "p75_lcp"}]
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  blob1 AS page_url,\n  quantileWeighted(0.75)(double1, _sample_interval) AS p75_lcp,\n  sum(_sample_interval) AS page_views\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob2 = 'LCP'\n  AND blob1 != ''\nGROUP BY page_url\nORDER BY p75_lcp DESC\nLIMIT 10",
          "refId": "A"
        }
      ],
      "title": "Top 10 Slowest Pages (LCP)",
      "type": "table"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "cellOptions": {"type": "auto"},
            "inspect": false
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": 0}]}
        },
        "overrides": [
          {
            "matcher": {"id": "byName", "options": "p75_inp"},
            "properties": [
              {"id": "unit", "value": "ms"},
              {"id": "thresholds", "value": {
                "mode": "absolute",
                "steps": [
                  {"color": "green", "value": 0},
                  {"color": "yellow", "value": 200},
                  {"color": "red", "value": 500}
                ]
              }},
              {"id": "custom.width", "value": 120}
            ]
          },
          {
            "matcher": {"id": "byName", "options": "interactions"},
            "properties": [{"id": "custom.width", "value": 100}]
          }
        ]
      },
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 22},
      "id": 11,
      "options": {
        "showHeader": true,
        "sortBy": [{"desc": true, "displayName": "p75_inp"}]
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  blob1 AS page_url,\n  quantileWeighted(0.75)(double1, _sample_interval) AS p75_inp,\n  sum(_sample_interval) AS interactions\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob2 = 'INP'\n  AND blob1 != ''\nGROUP BY page_url\nORDER BY p75_inp DESC\nLIMIT 10",
          "refId": "A"
        }
      ],
      "title": "Pages with Highest INP",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 30},
      "id": 104,
      "panels": [],
      "title": "Browser & Network Analysis",
      "type": "row"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "hideFrom": {"legend": false, "tooltip": false, "viz": false}
          },
          "mappings": [],
          "unit": "short"
        }
      },
      "gridPos": {"h": 8, "w": 8, "x": 0, "y": 31},
      "id": 12,
      "options": {
        "displayLabels": ["name", "percent"],
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true,
          "values": ["value"]
        },
        "pieType": "donut",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": true},
        "tooltip": {"mode": "single", "sort": "none"}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  blob5 AS browser,\n  sum(_sample_interval) AS count\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob5 != ''\nGROUP BY browser\nORDER BY count DESC",
          "refId": "A"
        }
      ],
      "title": "Sessions by Browser",
      "type": "piechart"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "hideFrom": {"legend": false, "tooltip": false, "viz": false}
          },
          "mappings": [],
          "unit": "short"
        }
      },
      "gridPos": {"h": 8, "w": 8, "x": 8, "y": 31},
      "id": 13,
      "options": {
        "displayLabels": ["name", "percent"],
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true,
          "values": ["value"]
        },
        "pieType": "donut",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": true},
        "tooltip": {"mode": "single", "sort": "none"}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  blob4 AS device,\n  sum(_sample_interval) AS count\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob4 != ''\nGROUP BY device\nORDER BY count DESC",
          "refId": "A"
        }
      ],
      "title": "Sessions by Device Type",
      "type": "piechart"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "hideFrom": {"legend": false, "tooltip": false, "viz": false}
          },
          "mappings": [
            {"options": {"2g": {"text": "2G"}}, "type": "value"},
            {"options": {"3g": {"text": "3G"}}, "type": "value"},
            {"options": {"4g": {"text": "4G"}}, "type": "value"},
            {"options": {"5g": {"text": "5G"}}, "type": "value"},
            {"options": {"unknown": {"text": "Unknown"}}, "type": "value"}
          ],
          "unit": "short"
        }
      },
      "gridPos": {"h": 8, "w": 8, "x": 16, "y": 31},
      "id": 14,
      "options": {
        "displayLabels": ["name", "percent"],
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true,
          "values": ["value"]
        },
        "pieType": "donut",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": true},
        "tooltip": {"mode": "single", "sort": "none"}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  blob6 AS connection,\n  sum(_sample_interval) AS count\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob6 != ''\nGROUP BY connection\nORDER BY count DESC",
          "refId": "A"
        }
      ],
      "title": "Sessions by Connection Type",
      "type": "piechart"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 39},
      "id": 105,
      "panels": [],
      "title": "Detailed Metrics Summary",
      "type": "row"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "displayMode": "auto"
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green"}]}
        },
        "overrides": [
          {
            "matcher": {"id": "byName", "options": "count"},
            "properties": [{"id": "custom.width", "value": 100}]
          },
          {
            "matcher": {"id": "byName", "options": "avg_value"},
            "properties": [
              {"id": "unit", "value": "ms"},
              {"id": "decimals", "value": 0},
              {"id": "custom.width", "value": 120}
            ]
          },
          {
            "matcher": {"id": "byName", "options": "p50_value"},
            "properties": [
              {"id": "unit", "value": "ms"},
              {"id": "decimals", "value": 0},
              {"id": "custom.width", "value": 120}
            ]
          },
          {
            "matcher": {"id": "byName", "options": "p75_value"},
            "properties": [
              {"id": "unit", "value": "ms"},
              {"id": "decimals", "value": 0},
              {"id": "custom.width", "value": 120},
              {"id": "custom.displayMode", "value": "color-background"}
            ]
          },
          {
            "matcher": {"id": "byName", "options": "p95_value"},
            "properties": [
              {"id": "unit", "value": "ms"},
              {"id": "decimals", "value": 0},
              {"id": "custom.width", "value": 120}
            ]
          },
          {
            "matcher": {"id": "byName", "options": "p99_value"},
            "properties": [
              {"id": "unit", "value": "ms"},
              {"id": "decimals", "value": 0},
              {"id": "custom.width", "value": 120}
            ]
          }
        ]
      },
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 40},
      "id": 15,
      "options": {
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 1,
          "queryType": "sql",
          "rawSql": "SELECT\n  blob2 AS metric,\n  sum(_sample_interval) AS count,\n  avg(double1) AS avg_value,\n  quantileWeighted(0.50)(double1, _sample_interval) AS p50_value,\n  quantileWeighted(0.75)(double1, _sample_interval) AS p75_value,\n  quantileWeighted(0.95)(double1, _sample_interval) AS p95_value,\n  quantileWeighted(0.99)(double1, _sample_interval) AS p99_value\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\nGROUP BY metric\nORDER BY metric",
          "refId": "A"
        }
      ],
      "title": "Metrics Summary with Percentiles",
      "type": "table"
    },
    {
      "datasource": "${datasource}",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Sessions",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 70,
            "gradientMode": "none",
            "hideFrom": {"legend": false, "tooltip": false, "viz": false},
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {"type": "linear"},
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {"group": "A", "mode": "normal"},
            "thresholdsStyle": {"mode": "off"}
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": 0}]},
          "unit": "short"
        }
      },
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 48},
      "id": 16,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "right",
          "showLegend": true
        },
        "tooltip": {"mode": "multi", "sort": "none"}
      },
      "pluginVersion": "10.0.0",
      "targets": [
        {
          "datasource": "${datasource}",
          "format": 0,
          "queryType": "sql",
          "rawSql": "SELECT\n  toStartOfInterval(toDateTime(double2 / 1000), INTERVAL 1 HOUR) AS time,\n  blob3 AS rating,\n  sum(_sample_interval) AS count\nFROM VITALS_ANALYTICS\nWHERE\n  timestamp >= now() - INTERVAL ${time_range}\n  AND blob2 = 'LCP'\n  AND blob3 IN ('good', 'needs-improvement', 'poor')\nGROUP BY time, rating\nORDER BY time",
          "refId": "A"
        }
      ],
      "title": "LCP Rating Distribution Over Time",
      "transformations": [
        {"id": "prepareTimeSeries", "options": {"format": "multi"}},
        {"id": "renameByRegex", "options": {"regex": "count (.*)", "renamePattern": "$1"}}
      ],
      "type": "timeseries"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 38,
  "tags": ["web-vitals", "performance", "cloudflare", "best-practices"],
  "templating": {
    "list": [
      {
        "current": {"text": "ClickHouse", "value": "ClickHouse"},
        "includeAll": false,
        "label": "Data Source",
        "name": "datasource",
        "options": [],
        "query": "vertamedia-clickhouse-datasource",
        "refresh": 1,
        "regex": "",
        "type": "datasource"
      },
      {
        "current": {"selected": false, "text": "24 HOUR", "value": "24 HOUR"},
        "hide": 0,
        "includeAll": false,
        "label": "Time Range",
        "multi": false,
        "name": "time_range",
        "options": [
          {"selected": false, "text": "1 Hour", "value": "1 HOUR"},
          {"selected": false, "text": "6 Hours", "value": "6 HOUR"},
          {"selected": false, "text": "12 Hours", "value": "12 HOUR"},
          {"selected": true, "text": "24 Hours", "value": "24 HOUR"},
          {"selected": false, "text": "7 Days", "value": "7 DAY"},
          {"selected": false, "text": "30 Days", "value": "30 DAY"}
        ],
        "query": "1 HOUR, 6 HOUR, 12 HOUR, 24 HOUR, 7 DAY, 30 DAY",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      }
    ]
  },
  "time": {"from": "now-24h", "to": "now"},
  "timepicker": {},
  "timezone": "",
  "title": "Enhanced Core Web Vitals Dashboard",
  "uid": "enhanced-web-vitals",
  "version": 1,
  "weekStart": ""
}